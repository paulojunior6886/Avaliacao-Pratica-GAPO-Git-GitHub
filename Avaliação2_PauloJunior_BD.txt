CREATE TABLE usuarios (
    id SERIAL PRIMARY KEY,
    login_usuario VARCHAR(50) UNIQUE NOT NULL,
    senha_usuario VARCHAR(255) NOT NULL,
    tipo_usuario VARCHAR(10) CHECK (tipo_usuario IN ('ADM', 'Funcionario', 'Cliente')) NOT NULL
);
/*INSERT INTO usuarios (nome_usuario, cpf_usuario, login_usuario, senha_usuario, tipo_usuario)
VALUES (
    'Usuário Teste',
    '123.456.789-00',
    'teste',
    '123456',  -- ATENÇÃO: essa é a senha em texto puro. Se estiver usando criptografia, insira o hash aqui.
    'Administrador'
);*/

CREATE TABLE clientes (
    id SERIAL PRIMARY KEY,
    nome_cliente VARCHAR(100) NOT NULL,
    cpf_cliente VARCHAR(14) UNIQUE NOT NULL,
    endereco_cliente VARCHAR(255),
    telefone_cliente VARCHAR(15),
    email_cliente VARCHAR(100)
);
CREATE TABLE veiculos (
    id SERIAL PRIMARY KEY,
    modelo_veiculo VARCHAR(100) NOT NULL,
    ano_fabricacao_veiculo INT NOT NULL,
    ano_modelo_veiculo INT NOT NULL,
    preco_veiculo DECIMAL(10,2) NOT NULL,
    cor_veiculo VARCHAR(30),
    placa_veiculo VARCHAR(10) UNIQUE NOT NULL,
    tipo_veiculo VARCHAR(15) CHECK (tipo_veiculo IN ('Carro', 'Moto')),
    marca_veiculo VARCHAR(50)
);
CREATE TABLE vendas (
    id SERIAL PRIMARY KEY,
    id_cliente INT NOT NULL,
    id_veiculo INT NOT NULL,
    data_venda DATE NOT NULL,
    valor_venda DECIMAL(10,2) NOT NULL,
    status_venda VARCHAR(15) CHECK (status_venda IN ('Pendente', 'Finalizada', 'Cancelada')),
    FOREIGN KEY (id_cliente) REFERENCES clientes(id),
    FOREIGN KEY (id_veiculo) REFERENCES veiculos(id)
);
select * from usuarios;
select * from clientes;
select * from veiculos;
select * from vendas;

ALTER TABLE veiculos ADD COLUMN caminho_imagem TEXT;


CREATE TABLE fornecedores (
    id SERIAL PRIMARY KEY,
    nome_fornecedor VARCHAR(150) NOT NULL,
    cnpj_fornecedor VARCHAR(18) UNIQUE NOT NULL, -- Formato: XX.XXX.XXX/XXXX-XX
    endereco_fornecedor VARCHAR(255),
    telefone_fornecedor VARCHAR(20),
    email_fornecedor VARCHAR(100),
    contato_principal VARCHAR(100) -- Nome da pessoa de contato principal no fornecedor
);
-- Exemplo de alteração na tabela veiculos:
ALTER TABLE veiculos
ADD COLUMN id_fornecedor INT,
ADD CONSTRAINT fk_fornecedor
    FOREIGN KEY (id_fornecedor)
    REFERENCES fornecedores(id);

CREATE TABLE opcionais (
    id_opcional SERIAL PRIMARY KEY,
    nome_opcional VARCHAR(100) UNIQUE NOT NULL,
    descricao_opcional TEXT,
    preco_adicional DECIMAL(10,2) DEFAULT 0
);

CREATE TABLE veiculo_opcionais (
    id_veiculo_fk INT NOT NULL,
    id_opcional_fk INT NOT NULL,
    CONSTRAINT fk_veiculo FOREIGN KEY (id_veiculo_fk) REFERENCES veiculos(id) ON DELETE CASCADE,
    CONSTRAINT fk_opcional FOREIGN KEY (id_opcional_fk) REFERENCES opcionais(id_opcional) ON DELETE CASCADE,
    PRIMARY KEY (id_veiculo_fk, id_opcional_fk)
);